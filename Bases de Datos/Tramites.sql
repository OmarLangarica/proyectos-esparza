CREATE DATABASE TRAMITES
GO
USE TRAMITES
GO
CREATE TABLE DEPENDENCIAS(
DENID INT NOT NULL,
DENNOMBRE NVARCHAR(50) NOT NULL,
DENDOMICILIO NVARCHAR(200) NOT NULL,
DENTELEFONO NCHAR(10) NOT NULL
)
GO
CREATE TABLE DEPARTAMENTOS(
DEPID INT NOT NULL,
DEPNOMBRE NVARCHAR(50) NOT NULL,
DEPDOMICILIO NVARCHAR(50) NOT NULL,
DEPTELEFONO NCHAR(10) NOT NULL,
DENID INT NOT NULL
)
GO
CREATE TABLE EMPLEADOS(
EMPID INT NOT NULL, 
EMPNOMBRE NVARCHAR(50) NOT NULL,
EMPAPELLIDOS NVARCHAR(50) NULL,
EMPTELEFONO NCHAR(10) NULL,
EMPCORREO NVARCHAR(50) NULL,
DEPID INT NOT NULL,
JEFEID INT NULL
)
GO
CREATE TABLE TIPOS(
TIPID INT NOT NULL,
TIPONOMBRE NVARCHAR(20) NOT NULL
)
GO
CREATE TABLE VENTANILLAS(
VENID INT NOT NULL,
VENNOMBRE NVARCHAR(50) NOT NULL,
TIPID INT NOT NULL
)
GO
CREATE TABLE FAMILIAS(
FAMID INT NOT NULL,
FAMNOMBRE NVARCHAR(50) NOT NULL
)
GO
CREATE TABLE TRAMITES(
TRAMID INT NOT NULL,
TRAMNOMBRE NVARCHAR(50) NOT NULL,
TRAMDESCRIPCION NVARCHAR(200) NULL,
TRAMCOSTO NUMERIC(10,2) NOT NULL,
FAMID INT NOT NULL
)
GO
CREATE TABLE ESTADOS(
EDOID INT NOT NULL,
EDONOMBRE NVARCHAR(50) NOT NULL
)
GO
CREATE TABLE MUNICIPIOS(
MUNID INT NOT NULL,
MUNNOMBRE NVARCHAR(50) NOT NULL,
EDOID INT NOT NULL
)
GO
CREATE TABLE COLONIAS(
COLID INT NOT NULL,
COLNOMBRE NVARCHAR(50) NOT NULL,
MUNID INT NOT NULL
)
GO
CREATE TABLE USUARIOS(
USUID INT NOT NULL,
USUNOMBRE NVARCHAR(50) NOT NULL,
USUAPELLIDOS NVARCHAR(50) NULL,
USUDOMICILIO NVARCHAR(50) NULL,
USUTELEFONO NCHAR(10) NULL,
USUCORREO NVARCHAR(50) NULL,
COLID INT NOT NULL
)
GO
CREATE TABLE REGISTRO(
FOLIO INT NOT NULL,
FECHACAPTURA DATETIME,
VENID INT NOT NULL,
EMPID INT NOT NULL,
USUID INT NOT NULL
)
GO
CREATE TABLE TRAMITESXREGISTRO(
FOLIO INT NOT NULL,
TRAMID INT NOT NULL,
FECHAFINAL DATETIME NOT NULL,
COSTO NUMERIC(10,2) NOT NULL
)
GO
--LLAVES PRIMARIAS
ALTER TABLE DEPENDENCIAS ADD CONSTRAINT PK_DEPENDENCIAS PRIMARY KEY(DENID)
GO
ALTER TABLE DEPARTAMENTOS ADD CONSTRAINT PK_DEPARTAMENTOS PRIMARY KEY(DEPID)
GO
ALTER TABLE EMPLEADOS ADD CONSTRAINT PK_EMPLEADOS PRIMARY KEY(EMPID)
GO
ALTER TABLE REGISTRO ADD CONSTRAINT PK_REGISTRO PRIMARY KEY(FOLIO)
GO
ALTER TABLE VENTANILLAS ADD CONSTRAINT PK_VENTANILLAS PRIMARY KEY(VENID)
GO
ALTER TABLE TIPOS ADD CONSTRAINT PK_TIPOS PRIMARY KEY(TIPID)
GO
ALTER TABLE TRAMITESXREGISTRO ADD CONSTRAINT PK_TRAMITESXREGISTRO PRIMARY KEY(FOLIO,TRAMID)
GO
ALTER TABLE TRAMITES ADD CONSTRAINT PK_TRAMITES PRIMARY KEY(TRAMID)
GO
ALTER TABLE FAMILIAS ADD CONSTRAINT PK_FAMILIAS PRIMARY KEY(FAMID)
GO
ALTER TABLE ESTADOS ADD CONSTRAINT PK_ESTADOS PRIMARY KEY(EDOID)
GO
ALTER TABLE MUNICIPIOS ADD CONSTRAINT PK_MUNICIPIOS PRIMARY KEY(MUNID)
GO
ALTER TABLE COLONIAS ADD CONSTRAINT PK_COLONIAS PRIMARY KEY(COLID)
GO
ALTER TABLE USUARIOS ADD CONSTRAINT PK_USUARIO PRIMARY KEY(USUID)
GO
--LLAVES EXTERNAS
ALTER TABLE DEPARTAMENTOS ADD CONSTRAINT FK_DEPARTAMENTOS_DEPENDENCIAS FOREIGN KEY(DENID) REFERENCES DEPENDENCIAS(DENID)
GO
ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMPLEADOS_DEPARTAMENTOS FOREIGN KEY(DEPID) REFERENCES DEPARTAMENTOS(DEPID)
GO
ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMPLEADOS_JEFES FOREIGN KEY(JEFEID) REFERENCES EMPLEADOS(EMPID)
GO
ALTER TABLE VENTANILLAS ADD CONSTRAINT FK_VENTANILLAS_TIPOS FOREIGN KEY(TIPID) REFERENCES TIPOS(TIPID)
GO
ALTER TABLE TRAMITES ADD CONSTRAINT FK_TRAMITES_FAMILIAS FOREIGN KEY(FAMID) REFERENCES FAMILIAS(FAMID)
GO
ALTER TABLE TRAMITESXREGISTRO ADD CONSTRAINT FK_TRAXREG_TRAMITES FOREIGN KEY(TRAMID) REFERENCES TRAMITES(TRAMID)
GO
ALTER TABLE TRAMITESXREGISTRO ADD CONSTRAINT FK_TRAXREG_REGISTRO FOREIGN KEY(FOLIO) REFERENCES REGISTRO(FOLIO)
GO
ALTER TABLE REGISTRO ADD CONSTRAINT FK_REGISTRO_EMPLEADOS FOREIGN KEY(EMPID) REFERENCES EMPLEADOS(EMPID)
GO
ALTER TABLE REGISTRO ADD CONSTRAINT FK_REGISTRO_USUARIOS FOREIGN KEY(USUID) REFERENCES USUARIOS(USUID)
GO
ALTER TABLE REGISTRO ADD CONSTRAINT FK_REGISTRO_VENTANILLAS FOREIGN KEY(VENID) REFERENCES VENTANILLAS(VENID)
GO
ALTER TABLE MUNICIPIOS ADD CONSTRAINT FK_MUNICIPIOS_ESTADO FOREIGN KEY(EDOID) REFERENCES ESTADOS(EDOID)
GO
ALTER TABLE COLONIAS ADD CONSTRAINT FK_COLONIAS_MUNICIPIOS FOREIGN KEY(MUNID) REFERENCES MUNICIPIOS(MUNID)
GO
ALTER TABLE USUARIOS ADD CONSTRAINT FK_USUARIOS_COLONIAS FOREIGN KEY(COLID) REFERENCES COLONIAS(COLID)
GO
--LLAVES UNICAS
ALTER TABLE EMPLEADOS ADD CONSTRAINT UC_EMPCORREO UNIQUE (EMPCORREO)
GO
ALTER TABLE USUARIOS ADD CONSTRAINT UC_USUCORREO UNIQUE (USUCORREO)
GO
--CHECK CONSTRAINT
ALTER TABLE TRAMITES ADD CONSTRAINT CC_TRAMITES_TRAMCOSTO CHECK(TRAMCOSTO>0)
GO
ALTER TABLE TRAMITESXREGISTRO ADD CONSTRAINT CC_TRAXREG_COSTO CHECK(COSTO>0)
GO
--VALORES PREDEFINIDOS
ALTER TABLE USUARIOS ADD CONSTRAINT DC_USUARIOS_DOM DEFAULT('Sin Domicilio') FOR USUDOMICILIO,
CONSTRAINT DC_USUARIOS_TEL DEFAULT('Sin telefono') FOR USUTELEFONO,
CONSTRAINT DC_USUARIOS_CORREO DEFAULT('Sin Correo') FOR USUCORREO
GO
ALTER TABLE EMPLEADOS ADD CONSTRAINT DC_EMPLEADOS_TEL DEFAULT('Sin Telefono') FOR EMPTELEFONO,
CONSTRAINT DC_EMPLEADOS_CORREO DEFAULT('Sin correo') FOR EMPCORREO
GO
--INSERCIONES
INSERT INTO DEPENDENCIAS (DENID, DENNOMBRE, DENDOMICILIO, DENTELEFONO) VALUES
(1, 'Secretaría de Finanzas', 'Av. Reforma 123, CDMX', '5512345678'),
(2, 'Secretaría de Educación', 'Calle Juárez 456, CDMX', '5523456789'),
(3, 'Secretaría de Salud', 'Blvd. Insurgentes 789, CDMX', '5534567890'),
(4, 'Secretaría de Transporte', 'Calle Morelos 321, CDMX', '5545678901'),
(5, 'Secretaría de Desarrollo', 'Av. Hidalgo 654, CDMX', '5556789012')
GO
INSERT INTO DEPARTAMENTOS (DEPID, DEPNOMBRE, DEPDOMICILIO, DEPTELEFONO, DENID) VALUES
(1, 'Contabilidad', 'Oficina 101', '5511111111', 1),
(2, 'Recursos Humanos', 'Oficina 102', '5522222222', 2),
(3, 'Atención Ciudadana', 'Oficina 103', '5533333333', 3),
(4, 'Transporte Público', 'Oficina 104', '5544444444', 4),
(5, 'Obras Públicas', 'Oficina 105', '5555555555', 5)
GO
INSERT INTO EMPLEADOS (EMPID, EMPNOMBRE, EMPAPELLIDOS, EMPTELEFONO, EMPCORREO, DEPID, JEFEID) VALUES
(1, 'Juan', 'Pérez López', '5612345678', 'juan.perez@hotmail.com', 1, NULL),
(2, 'María', 'García Torres', '5623456789', 'maria.garcia@gmail.com', 2, 1),
(3, 'Luis', 'Hernández Díaz', '5634567890', 'luis.hernandez@hotmail.com', 3, 1),
(4, 'Ana', 'Martínez Ruiz', '5645678901', 'ana.martinez@outlook.com', 4, 2),
(5, 'Carlos', 'Rodríguez Fernández', '5656789012', 'carlos.rodriguez@gmail.com', 5, 3)
GO
INSERT INTO TIPOS (TIPID, TIPONOMBRE) VALUES
(1, 'Consulta'),
(2, 'Pago'),
(3, 'Solicitud'),
(4, 'Registro'),
(5, 'Trámite')
GO
INSERT INTO VENTANILLAS (VENID, VENNOMBRE, TIPID) VALUES
(1, 'Ventanilla 1', 1),
(2, 'Ventanilla 2', 2),
(3, 'Ventanilla 3', 3),
(4, 'Ventanilla 4', 4),
(5, 'Ventanilla 5', 5)
GO
INSERT INTO FAMILIAS (FAMID, FAMNOMBRE) VALUES
(1, 'Licencias'),
(2, 'Actas'),
(3, 'Permisos'),
(4, 'Multas'),
(5, 'Registros')
GO
INSERT INTO TRAMITES (TRAMID, TRAMNOMBRE, TRAMDESCRIPCION, TRAMCOSTO, FAMID) VALUES
(1, 'Licencia de Conducir', 'Expedición de licencia tipo A', 500.00, 1),
(2, 'Acta de Nacimiento', 'Copia certificada', 150.00, 2),
(3, 'Permiso de Construcción', 'Autorización para construcción', 2500.00, 3),
(4, 'Pago de Multas', 'Pago de infracciones de tránsito', 800.00, 4),
(5, 'Registro de Propiedad', 'Registro ante el notario', 3000.00, 5)
GO
INSERT INTO ESTADOS (EDOID, EDONOMBRE) VALUES
(1, 'Ciudad de México'),
(2, 'Jalisco'),
(3, 'Nuevo León'),
(4, 'Puebla'),
(5, 'Veracruz')
GO
INSERT INTO MUNICIPIOS (MUNID, MUNNOMBRE, EDOID) VALUES
(1, 'Coyoacán', 1),
(2, 'Guadalajara', 2),
(3, 'Monterrey', 3),
(4, 'Puebla', 4),
(5, 'Xalapa', 5)
GO
INSERT INTO COLONIAS (COLID, COLNOMBRE, MUNID) VALUES
(1, 'Centro', 1),
(2, 'Chapultepec', 2),
(3, 'San Pedro', 3),
(4, 'Zócalo', 4),
(5, 'El Mirador', 5)
GO
INSERT INTO USUARIOS (USUID, USUNOMBRE, USUAPELLIDOS, USUDOMICILIO, USUTELEFONO, USUCORREO, COLID) VALUES
(1, 'Fernando', 'López Gómez', 'Calle 1 #123', '5690123456', 'fernando.lopez@gmail.com', 1),
(2, 'Clara', 'Martínez Soto', 'Calle 2 #456', '5678901234', 'clara.martinez@gmail.com', 2),
(3, 'Diego', 'Ruiz Fernández', 'Calle 3 #789', '5656789012', 'diego.ruiz@gmail.com', 3),
(4, 'Andrea', 'Hernández Castro', 'Calle 4 #321', '5634567890', 'andrea.hernandez@gmail.com', 4),
(5, 'Roberto', 'Sánchez Ortiz', 'Calle 5 #654', '5612345678', 'roberto.sanchez@gmail.com', 5)
GO
INSERT INTO REGISTRO (FOLIO, FECHACAPTURA, VENID, EMPID, USUID) VALUES
(1, '2024-02-16 08:30:00', 1, 1, 1),
(2, '2024-02-16 09:00:00', 2, 2, 2),
(3, '2024-02-16 09:30:00', 3, 3, 3),
(4, '2024-02-16 10:00:00', 4, 4, 4),
(5, '2024-02-16 10:30:00', 5, 5, 5)
GO
INSERT INTO TRAMITESXREGISTRO (FOLIO, TRAMID, FECHAFINAL, COSTO) VALUES
(1, 1, '2024-02-20 12:00:00', 500.00),
(2, 2, '2024-02-21 12:00:00', 150.00),
(3, 3, '2024-02-22 12:00:00', 2500.00),
(4, 4, '2024-02-23 12:00:00', 800.00),
(5, 5, '2024-02-24 12:00:00', 3000.00)
GO